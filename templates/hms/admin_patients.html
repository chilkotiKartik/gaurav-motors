{% extends 'hms/base.html' %}
{% block content %}
<h2>Patients</h2>
<div class="d-flex justify-content-between mb-3">
  <a class="btn btn-success" href="{{ url_for('admin_add_patient') }}">Add Patient</a>
  <form class="d-flex" method="get" style="width: 300px;">
    <input name="q" class="form-control" placeholder="Search patients by name" value="{{ request.args.get('q','') }}">
  </form>
</div>
<ul class="list-group mt-3">
  {% for p in patients %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>{{ p.name }} | {{ p.contact or 'N/A' }} | <small>{{ p.user.username }}</small></div>
      <div>
        <a class="btn btn-sm btn-primary" href="{{ url_for('admin_edit_patient', patient_id=p.id) }}">Edit</a>
        <form method="post" action="{{ url_for('admin_delete_patient', patient_id=p.id) }}" style="display:inline" onsubmit="return confirm('Delete this patient?')">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
      </div>
    </li>
  {% else %}
    <li class="list-group-item">No patients</li>
  {% endfor %}
</ul>
<a class="btn btn-secondary mt-3" href="{{ url_for('admin_dashboard') }}">Back to Dashboard</a>
{% endblock %}
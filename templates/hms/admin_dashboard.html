{% extends 'hms/base.html' %}
{% block content %}

<!-- Dashboard Header -->
<div class="dashboard-header mb-4 p-4 rounded-4 shadow-lg position-relative overflow-hidden" style="background: linear-gradient(135deg, rgba(13,110,253,0.08) 0%, rgba(11,91,176,0.05) 100%);">
  <div style="position: absolute; right: -50px; top: -30px; opacity: 0.06; pointer-events: none;">
    <i class="fas fa-hospital" style="font-size: 200px; color: #0d6efd;"></i>
  </div>
  <div class="row align-items-center position-relative" style="z-index: 1;">
    <div class="col-md-8">
      <h2 class="mb-0">
        <i class="fas fa-tachometer-alt text-success me-2"></i>
        Admin Dashboard
      </h2>
      <p class="text-muted mb-0 mt-2">
        <i class="fas fa-user-shield me-1"></i> System Overview & Management
      </p>
    </div>
    <div class="col-md-4 text-end">
      <a class="btn btn-success" href="{{ url_for('add_doctor') }}">
        <i class="fas fa-user-plus me-1"></i> Add New Doctor
      </a>
    </div>
  </div>
</div>

<!-- Stats Cards -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #4caf50 !important;">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-muted mb-2">Total Doctors</h6>
            <h2 class="mb-0 text-success">{{ num_doctors }}</h2>
            <small class="text-success">
              <i class="fas fa-arrow-up"></i> Active
            </small>
          </div>
          <div class="bg-success bg-opacity-10 p-3 rounded">
            <i class="fas fa-user-md fa-2x text-success"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #2196F3 !important;">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-muted mb-2">Total Patients</h6>
            <h2 class="mb-0 text-primary">{{ num_patients }}</h2>
            <small class="text-primary">
              <i class="fas fa-arrow-up"></i> Registered
            </small>
          </div>
          <div class="bg-primary bg-opacity-10 p-3 rounded">
            <i class="fas fa-users fa-2x text-primary"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #ff9800 !important;">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-muted mb-2">Appointments</h6>
            <h2 class="mb-0 text-warning">{{ num_appointments }}</h2>
            <small class="text-warning">
              <i class="fas fa-calendar"></i> Total
            </small>
          </div>
          <div class="bg-warning bg-opacity-10 p-3 rounded">
            <i class="fas fa-calendar-check fa-2x text-warning"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #9c27b0 !important;">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-muted mb-2">Trees Saved</h6>
            <h2 class="mb-0" style="color: #9c27b0;">10,247</h2>
            <small style="color: #9c27b0;">
              <i class="fas fa-leaf"></i> Eco Impact
            </small>
          </div>
          <div class="bg-purple bg-opacity-10 p-3 rounded">
            <i class="fas fa-tree fa-2x" style="color: #9c27b0;"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Doctors Management -->
<div class="card border-0 shadow-sm mb-4">
  <div class="card-header bg-white border-bottom py-3">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0">
        <i class="fas fa-user-md text-success me-2"></i>
        Doctors Management
      </h5>
      <a class="btn btn-success btn-sm" href="{{ url_for('add_doctor') }}">
        <i class="fas fa-plus me-1"></i> Add Doctor
      </a>
    </div>
  </div>
  <div class="card-body p-0">
    {% if doctors %}
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="bg-light">
            <tr>
              <th><i class="fas fa-hashtag me-1"></i> ID</th>
              <th><i class="fas fa-user-md me-1"></i> Doctor Name</th>
              <th><i class="fas fa-stethoscope me-1"></i> Specialization</th>
              <th><i class="fas fa-phone me-1"></i> Contact</th>
              <th class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for d in doctors %}
            <tr>
              <td><span class="badge bg-light text-dark">#{{ d.id }}</span></td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="avatar-sm bg-success bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-2">
                    <i class="fas fa-user-md text-success"></i>
                  </div>
                  <strong>{{ d.name }}</strong>
                </div>
              </td>
              <td>
                <span class="badge bg-info">{{ d.specialization }}</span>
              </td>
              <td>
                <i class="fas fa-phone text-muted me-1"></i>
                {{ d.contact or 'Not provided' }}
              </td>
              <td class="text-end">
                <a class="btn btn-sm btn-outline-primary" href="{{ url_for('admin_edit_doctor', doctor_id=d.id) }}" title="Edit">
                  <i class="fas fa-edit"></i> Edit
                </a>
                <form method="post" action="{{ url_for('admin_delete_doctor', doctor_id=d.id) }}" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this doctor?')">
                  <button class="btn btn-sm btn-outline-danger" title="Delete">
                    <i class="fas fa-trash"></i> Delete
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-center py-5">
        <i class="fas fa-user-md fa-3x text-muted mb-3"></i>
        <h5 class="text-muted">No Doctors Found</h5>
        <p class="text-muted mb-3">Add your first doctor to get started!</p>
        <a class="btn btn-success" href="{{ url_for('add_doctor') }}">
          <i class="fas fa-plus me-2"></i>Add Doctor
        </a>
      </div>
    {% endif %}
  </div>
</div>

<!-- Quick Actions -->
<div class="row">
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100 hover-lift">
      <div class="card-body text-center">
        <div class="mb-3">
          <i class="fas fa-users fa-3x text-success"></i>
        </div>
        <h6>Manage Patients</h6>
        <p class="text-muted small mb-3">View and manage all patients</p>
        <a href="{{ url_for('admin_patients') }}" class="btn btn-success btn-sm w-100">
          <i class="fas fa-arrow-right me-1"></i> Go to Patients
        </a>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100 hover-lift">
      <div class="card-body text-center">
        <div class="mb-3">
          <i class="fas fa-user-md fa-3x text-primary"></i>
        </div>
        <h6>View All Doctors</h6>
        <p class="text-muted small mb-3">Browse complete doctor list</p>
        <a href="{{ url_for('list_doctors') }}" class="btn btn-primary btn-sm w-100">
          <i class="fas fa-arrow-right me-1"></i> Go to Doctors
        </a>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100 hover-lift">
      <div class="card-body text-center">
        <div class="mb-3">
          <i class="fas fa-calendar-alt fa-3x text-warning"></i>
        </div>
        <h6>Appointments</h6>
        <p class="text-muted small mb-3">View all appointments</p>
        <button class="btn btn-warning btn-sm w-100" disabled>
          <i class="fas fa-arrow-right me-1"></i> Coming Soon
        </button>
      </div>
    </div>
  </div>
  
  <div class="col-md-3">
    <div class="card border-0 shadow-sm h-100 hover-lift">
      <div class="card-body text-center">
        <div class="mb-3">
          <i class="fas fa-chart-bar fa-3x" style="color: #9c27b0;"></i>
        </div>
        <h6>Analytics</h6>
        <p class="text-muted small mb-3">View system statistics</p>
        <button class="btn btn-sm w-100" style="background-color: #9c27b0; color: white;" disabled>
          <i class="fas fa-arrow-right me-1"></i> Coming Soon
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Recent Activity Section -->
<div class="card border-0 shadow-sm mt-4">
  <div class="card-header bg-white border-bottom py-3">
    <h5 class="mb-0">
      <i class="fas fa-history text-success me-2"></i>
      System Information
    </h5>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-6">
        <h6 class="text-muted mb-3">System Status</h6>
        <ul class="list-unstyled">
          <li class="mb-2">
            <i class="fas fa-check-circle text-success me-2"></i>
            <strong>Database:</strong> Connected & Running
          </li>
          <li class="mb-2">
            <i class="fas fa-check-circle text-success me-2"></i>
            <strong>Server:</strong> Online
          </li>
          <li class="mb-2">
            <i class="fas fa-check-circle text-success me-2"></i>
            <strong>Green Theme:</strong> Active
          </li>
        </ul>
      </div>
      <div class="col-md-6">
        <h6 class="text-muted mb-3">Environmental Impact</h6>
        <div class="mb-2">
          <small class="text-muted">Trees Saved</small>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar bg-success" role="progressbar" style="width: 85%">10,247</div>
          </div>
        </div>
        <div class="mb-2">
          <small class="text-muted">COâ‚‚ Reduced</small>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar bg-primary" role="progressbar" style="width: 70%">52.5 tons</div>
          </div>
        </div>
        <div class="mb-2">
          <small class="text-muted">Papers Saved</small>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar bg-warning" role="progressbar" style="width: 90%">1.2M sheets</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .dashboard-header {
    background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
    padding: 2rem;
    border-radius: 12px;
    border-left: 5px solid #4caf50;
  }
  
  .hover-lift {
    transition: all 0.3s ease;
  }
  
  .hover-lift:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1) !important;
  }
  
  .avatar-sm {
    width: 35px;
    height: 35px;
    font-size: 14px;
  }
  
  .table tbody tr {
    transition: all 0.2s ease;
  }
  
  .table tbody tr:hover {
    background-color: #e8f5e9;
    transform: scale(1.01);
  }
  
  .progress {
    border-radius: 10px;
  }
  
  .progress-bar {
    border-radius: 10px;
    font-weight: bold;
  }
</style>

{% endblock %}